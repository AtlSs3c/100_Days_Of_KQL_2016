DeviceProcessEvents
| where Timestamp > ago(30d)
| where (
    tolower(ProcessVersionInfoOriginalFileName) == "autoit3.exe"
    or tolower(ProcessVersionInfoProductName) has "autoit"
    or tolower(ProcessVersionInfoFileDescription) has "autoit"
)
| where tolower(FileName) != "autoit3.exe"
| where tolower(FolderPath) matches regex @"\\users\\|\\programdata\\|\\windows\\temp\\|\\temp\\"
| where not(tolower(FolderPath) has @"\program files\autoit3\")
| where not(tolower(FolderPath) has @"\program files (x86)\autoit3\")
| where not(
    tolower(FileName) has "setup"
    or tolower(FileName) has "install"
    or tolower(ProcessVersionInfoFileDescription) has "setup"
)
| project Timestamp, DeviceName, AccountName, FileName, FolderPath, ProcessCommandLine,
          ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName,
          ProcessVersionInfoFileDescription, InitiatingProcessFileName, InitiatingProcessFolderPath

